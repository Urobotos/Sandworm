
################################################################
# EXP1 / EXP2 (display) pins Aliases:
################################################################

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE8, EXP1_2=PE7,
    EXP1_3=PE9, EXP1_4=PE10,
    EXP1_5=PE12, EXP1_6=PE13,    # Slot in the socket on this side
    EXP1_7=PE14, EXP1_8=PE15,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PB1, EXP2_4=PA4,
    EXP2_5=PB2, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PC15, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=PC5


#####################################################################
#   Display Bigtreetech Mini 12864 V2.0
#####################################################################

[display]
lcd_type: uc1701
cs_pin: EXP1_3
a0_pin: EXP1_4
rst_pin: EXP1_5
encoder_pins: ^EXP2_5, ^EXP2_3
click_pin: ^!EXP1_2
contrast: 63
spi_software_miso_pin: EXP2_1
spi_software_mosi_pin: EXP2_6
spi_software_sclk_pin: EXP2_2
menu_timeout: 40

## Settings for Beeper on Display
[output_pin beeper]
pin: EXP1_1
pwm: True
value: 0
shutdown_value: 0
cycle_time: 0.100  
# scale: 1000

## RGB LED on Display
[neopixel Display_LED]
pin: EXP1_6
chain_count: 3
initial_RED: 0.02
initial_GREEN: 0.05
initial_BLUE: 0.1
color_order: BRG

## Example of Gcode for set RGB LED on display: 
# SET_LED LED=Display_LED RED=0.02 GREEN=0.05 BLUE=0.1 INDEX=1 TRANSMIT=1     # index=1: Knob
# SET_LED LED=Display_LED RED=0.02 GREEN=0.05 BLUE=0.1 INDEX=2 TRANSMIT=1     # index=2: Display led1
# SET_LED LED=Display_LED RED=0.02 GREEN=0.05 BLUE=0.1 INDEX=3 TRANSMIT=1     # index=3: Display led2

#####################################################################
#   Macros:
#####################################################################
## M300 nd Play tone macros:
[gcode_macro M300]
gcode:
    {% set frequency = params.S|default(1000)|int %}
    {% set duration = params.P|default(500)|int %}
    {% set pwm_value = frequency / 10000 %}
    SET_PIN PIN=beeper VALUE={pwm_value}
    G4 P{duration}
    SET_PIN PIN=beeper VALUE=0
    
[gcode_macro play_tone]
variable_frequency: 500    # Basic frekvence
variable_duration: 200     # Tone Duration
variable_pause: 100        # Delay between tones
gcode:
    M300 S{frequency} P{duration}
    G4 P{pause}

## Langage change macro
## 1 = English, 2 = Czech, 3 = German
[gcode_macro SET_MENU_LANGUAGE]
description: LCD menu language
variable_language: 1
gcode:
    {% set lang = params.LANGUAGE | default(1) | int %}
	SET_GCODE_VARIABLE MACRO=SET_MENU_LANGUAGE VARIABLE=language VALUE={ lang }
    SAVE_VARIABLE VARIABLE=lang VALUE={ lang }
	{% if lang == 1 %}          
	   M117 English selected
	{% elif lang == 2 %}
	   M117 Zvolena cestina
    {% elif lang == 3 %}
	   M117 Deutsch ausgewahlt
	{% endif %}

## LCD message on printer startup
[delayed_gcode lcd_message]
initial_duration: 1
gcode:
    {% set lang = printer.save_variables.variables.lang | default(1) %}
    {% if lang == 1 %}          
	   M117 Ready
	{% elif lang == 2 %}
	   M117 Tisk. pripravena
    {% elif lang == 3 %}
	   M117 Bereit
	{% endif %}

## Knob LED green feedback
## 1 = feedback ON, 0 = feedback OFF
[gcode_macro knob_feedback]
description: Knob LED feedback
variable_knob: 1
gcode:
    {% set value_knob = params.KNOB | default(1) | int %}
	SET_GCODE_VARIABLE MACRO=knob_feedback VARIABLE=knob VALUE={ value_knob }
    SAVE_VARIABLE VARIABLE=knob VALUE={ value_knob }

## Knob feedback: Retur Knob LEDs to defaut state:
[delayed_gcode knob_feedback_return]
initial_duration: 0
gcode:
   {% set VALUE_RED = printer.configfile.config['neopixel Display_LED'].initial_red | default(0.02) | float | round(2) %}                      
   {% set VALUE_GREEN = printer.configfile.config['neopixel Display_LED'].initial_green | default(0.05) | float | round(2) %}
   {% set VALUE_BLUE = printer.configfile.config['neopixel Display_LED'].initial_blue | default(0.1) | float | round(2) %}
   SET_LED LED=Display_LED RED={VALUE_RED} GREEN={VALUE_GREEN} BLUE={VALUE_BLUE} INDEX=1 TRANSMIT=1

## Load and set correct Knob value on printer startup:
[delayed_gcode knob_on_reboot]
initial_duration: 1
gcode:
    {% set value_knob = printer.save_variables.variables.knob %}
	knob_feedback KNOB={value_knob}


################################################################
# LCD menu:
################################################################
# For exit after command - { menu.exit() }
# For back after command - {menu.back()}

### Offer structure (English version) ###
# Main
#   + Adjust print
#       + Ex0:000 (0000)
#       + Bed:000 (0000)
#       + Speed: 000%
#       + Flow: 000%
#       + Offset Z:00.00
#       + Fan speed
#   + SD print
#       + Start printing
#       + Resume printing            
#       + Pause printing             
#       + Cancel printing            
#       + ... (files)
#   + Control
#       + Move XYZ,E
#         + Move 10mm
#             + Move X:000.0
#             + Move Y:000.0
#             + Move Z:000.0
#             + Move E:+000.0
#         + Move 1mm
#             + Move X:000.0
#             + Move Y:000.0
#             + Move Z:000.0
#             + Move E:+000.0
#         + Move 0.1mm
#             + Move X:000.0
#             + Move Y:000.0
#             + Move Z:000.0
#             + Move E:+000.0
#       + Home All
#       + Home X/Y
#       + Home Z
#       + Park toolhead
#       + Steppers off
#       + E Stepper off
#       + Fan: OFF
#       + Fan speed: 000%
#   + Temperature
#       + Ex0:000 (0000)
#       + Bed:000 (0000)
#       + Preheat PLA
#           + Preheat all
#           + Preheat hotend
#           + Preheat hotbed
#       + Preheat PETG
#           + Preheat all
#           + Preheat hotend
#           + Preheat hotbed
#       + Preheat ABS
#           + Preheat all
#           + Preheat hotend
#           + Preheat hotbed
#       + Preheat PROBE
#           + Preheat all
#           + Preheat hotend
#           + Preheat hotbed
#       + Cooldown
#           + Cooldown all
#           + HotEnd off
#           + HotBed off
#   + Filament
#       + Ex0:000 (0000)
#       + Load Fil.
#           + Load PLA
#           + Load PETG
#           + Load ABS
#       + Unload Fil.
#           + Unload PLA
#           + Unload PETG
#           + Unload ABS   
#       + Change Fil.
#           + Change PLA
#           + Change PETG
#           + Change ABS
#       + Move E: 000.0 mm
#       + E Stepper off
#   + lights
#       + lights: ON/OF
#       + Bright: 0.3
#       + lights on max.
#       + Red: 0.30
#       + Green: 0.30
#       + Blue: 0.30
#   + Chamber
#       + Current: <temperature>
#       + Cool at: 35Â°C
#   + Setup
#       + Power Management
#           + Restart
#           + Restart FW
#           + Power Off
#       + Calibration
#           + Preheat: 
#              + Preheat all      
#              + Preheat hotend   
#              + Preheat hotbed   
#           + Home All
#           + Bed Mesh            
#           + Z Tilt 
#           + PID tuning
#              + Tune Hotend PID
#              + Tune Hotbed PID
#           + Z ENDSTOP CALIBRATE
#           + PROBE CALIBRATE
#           + Save config
#       + Language
#           + English
#           + Cestina
#           + Deutsch
#       + Display knob
#       + Bed Lowrider



[menu __main]
type: list
name: { "Hlavni nabidka" if printer.save_variables.variables.lang == 2 else "Hauptmenu" if printer.save_variables.variables.lang == 3 else "Main Menu" }

##############################################################
##    Menu - Adjust print                                    #
##############################################################

[menu __main __tune]
type: list
enable: {printer.idle_timeout.state == "Printing"}
name: { "Doladeni tisku" if printer.save_variables.variables.lang == 2 else "Feineinstellungen" if printer.save_variables.variables.lang == 3 else "Adjust print" }

[menu __main __tune __hotend0_target]
type: input
name: {"Ext:%3.0f (%4.0f)~degrees~" % (menu.input, printer.extruder.temperature)}
index: 1
input: {printer.extruder.target}
input_min: 0
input_max: {printer.configfile.config.extruder.max_temp}
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1  # Knob LED Feedback
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5        # Return Knob LED to default state after 0.6 sec
    {% endif %} 
    M104 T0 S{'%.0f' % menu.input}

[menu __main __tune __hotbed_target]
type: input
name: {"Bed:%3.0f (%4.0f)~degrees~" % (menu.input, printer.heater_bed.temperature)}
index: 2
input: {printer.heater_bed.target}
input_min: 0
input_max: {printer.configfile.config.heater_bed.max_temp}
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S{'%.0f' % menu.input}

[menu __main __tune __speed]
type: input
name: { "Rychlost" if printer.save_variables.variables.lang == 2 else "Geschw." if printer.save_variables.variables.lang == 3 else "Speed" } {'%3d' % (menu.input*100)}%
input: {printer.gcode_move.speed_factor}
input_min: 0.01
input_max: 5
input_step: 0.01
realtime: True
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M220 S{'%d' % (menu.input*100)}

[menu __main __tune __flow]
type: input
name: { "Prutok" if printer.save_variables.variables.lang == 2 else "Fluss" if printer.save_variables.variables.lang == 3 else "Flow" } {'%3d' % (menu.input*100)}%
input: {printer.gcode_move.extrude_factor}
input_min: 0.01
input_max: 2
input_step: 0.01
realtime: True
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M221 S{'%d' % (menu.input*100)}

[menu __main __tune __offsetz]
type: input
name: { "Z offset" if printer.save_variables.variables.lang == 2 else "Offset Z:" if printer.save_variables.variables.lang == 3 else "Offset Z:" } {'%05.3f' % menu.input}
input: {printer.gcode_move.homing_origin.z}
input_min: -5
input_max: 5
input_step: 0.005
realtime: True
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SET_GCODE_OFFSET Z={'%.3f' % menu.input} MOVE=1

[menu __main __tune __fanspeed]
type: input
name: { "Fan speed" if printer.save_variables.variables.lang == 2 else "Lufter:" if printer.save_variables.variables.lang == 3 else "Fan speed:" } {'%3d' % (menu.input*100)}%
input: {printer.fan.speed}
input_min: 0
input_max: 1
input_step: 0.01
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M106 S{'%d' % (menu.input*255)}
	

##############################################################
##    Menu - SD print                                        #
##############################################################

[menu __main __sdcard]
type: vsdlist
enable: {('virtual_sdcard' in printer)}
name: { "SD Tisk" if printer.save_variables.variables.lang == 2 else "SD-Druck" if printer.save_variables.variables.lang == 3 else "SD print" }

[menu __main __sdcard __start]
type: command
enable: {('virtual_sdcard' in printer) and printer.virtual_sdcard.file_path and not printer.virtual_sdcard.is_active}
name: { "Zahajit tisk" if printer.save_variables.variables.lang == 2 else "Druck starten" if printer.save_variables.variables.lang == 3 else "Start printing" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M24

[menu __main __sdcard __resume]
type: command
enable: {('virtual_sdcard' in printer) and printer.print_stats.state == "paused"}
name: { "Obnovit tisk" if printer.save_variables.variables.lang == 2 else "Druck fortset." if printer.save_variables.variables.lang == 3 else "Resume printing" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {% if "pause_resume" in printer %}
        RESUME
    {% else %}
        M24
    {% endif %}

[menu __main __sdcard __pause]
type: command
enable: {('virtual_sdcard' in printer) and printer.print_stats.state == "printing"}
name: { "Pauza tisku" if printer.save_variables.variables.lang == 2 else "Druck pausieren" if printer.save_variables.variables.lang == 3 else "Pause printing" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {% if "pause_resume" in printer %}
        PAUSE
    {% else %}
        M25
    {% endif %}

[menu __main __sdcard __cancel]
type: command
enable: {('virtual_sdcard' in printer) and (printer.print_stats.state == "printing" or printer.print_stats.state == "paused")}
name: { "Zrusit tisk" if printer.save_variables.variables.lang == 2 else "Druck abbrechen" if printer.save_variables.variables.lang == 3 else "Cancel printing" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {% if 'pause_resume' in printer %}
        CANCEL_PRINT
    {% else %}
        M25
        M27
        M26 S0
        TURN_OFF_HEATERS
        {% if printer.toolhead.position.z <= printer.toolhead.axis_maximum.z - 5 %}
            G91
            G0 Z5 F1000
            G90
        {% endif %}
    {% endif %}


##############################################################
##    Menu - Control                                        #
##############################################################

[menu __main __control]
type: list
name: { "Ovladani" if printer.save_variables.variables.lang == 2 else "Steuerung" if printer.save_variables.variables.lang == 3 else "Control" }

[menu __main __control __move]
type: list
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb XYZ,E" if printer.save_variables.variables.lang == 2 else "Bewegen XYZ,E" if printer.save_variables.variables.lang == 3 else "Move XYZ,E" }
index: 0

[menu __main __control __move __move10mm]
type: list
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb o 10mm" if printer.save_variables.variables.lang == 2 else "10mm bewegen" if printer.save_variables.variables.lang == 3 else "Move 10mm" }

[menu __main __control __move __move10mm __axis_x]
type: input
name: { "Pohyb X:" if printer.save_variables.variables.lang == 2 else "X bewegen:" if printer.save_variables.variables.lang == 3 else "Move X:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.x}
input_min: {printer.toolhead.axis_minimum.x}
input_max: {printer.toolhead.axis_maximum.x}
input_step: 10.0
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 X{menu.input}
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move10mm __axis_y]
type: input
name: { "Pohyb Y:" if printer.save_variables.variables.lang == 2 else "Y bewegen:" if printer.save_variables.variables.lang == 3 else "Move Y:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.y}
input_min: {printer.toolhead.axis_minimum.y}
input_max: {printer.toolhead.axis_maximum.y}
input_step: 10.0
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 Y{menu.input}
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move10mm __axis_z]
type: input
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb Z:" if printer.save_variables.variables.lang == 2 else "Z bewegen:" if printer.save_variables.variables.lang == 3 else "Move Z:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.z}
input_min: 0
input_max: {printer.toolhead.axis_maximum.z}
input_step: 10.0
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 Z{menu.input} F720
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move10mm __axis_e]
type: input
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb E:" if printer.save_variables.variables.lang == 2 else "E bewegen:" if printer.save_variables.variables.lang == 3 else "Move E:" } {'%+06.1f' % menu.input}
input: 0
input_min: -{printer.configfile.config.extruder.max_extrude_only_distance|default(50)}
input_max: {printer.configfile.config.extruder.max_extrude_only_distance|default(50)}
input_step: 10.0
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    M83
    G1 E{menu.input} F240
    RESTORE_GCODE_STATE NAME=__move__axis


[menu __main __control __move __move1mm]
type: list
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb o 1mm" if printer.save_variables.variables.lang == 2 else "1mm bewegen" if printer.save_variables.variables.lang == 3 else "Move 1mm" }

[menu __main __control __move __move1mm __axis_x]
type: input
name: { "Pohyb X:" if printer.save_variables.variables.lang == 2 else "X bewegen:" if printer.save_variables.variables.lang == 3 else "Move X:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.x}
input_min: {printer.toolhead.axis_minimum.x}
input_max: {printer.toolhead.axis_maximum.x}
input_step: 1.0
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 X{menu.input}
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move1mm __axis_y]
type: input
name: { "Pohyb Y:" if printer.save_variables.variables.lang == 2 else "Y bewegen:" if printer.save_variables.variables.lang == 3 else "Move Y:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.y}
input_min: {printer.toolhead.axis_minimum.y}
input_max: {printer.toolhead.axis_maximum.y}
input_step: 1.0
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 Y{menu.input}
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move1mm __axis_z]
type: input
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb Z:" if printer.save_variables.variables.lang == 2 else "Z bewegen:" if printer.save_variables.variables.lang == 3 else "Move Z:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.z}
input_min: 0
input_max: {printer.toolhead.axis_maximum.z}
input_step: 1.0
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 Z{menu.input} F720
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move1mm __axis_e]
type: input
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb E:" if printer.save_variables.variables.lang == 2 else "E bewegen:" if printer.save_variables.variables.lang == 3 else "Move E:" } {'%+06.1f' % menu.input}
input: 0
input_min: -{printer.configfile.config.extruder.max_extrude_only_distance|default(50)}
input_max: {printer.configfile.config.extruder.max_extrude_only_distance|default(50)}
input_step: 1.0
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    M83
    G1 E{menu.input} F240
    RESTORE_GCODE_STATE NAME=__move__axis


[menu __main __control __move __move01mm]
type: list
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb o 0.1mm" if printer.save_variables.variables.lang == 2 else "0.1mm bewegen" if printer.save_variables.variables.lang == 3 else "Move 0.1mm" }

[menu __main __control __move __move01mm __axis_x]
type: input
name: { "Pohyb X:" if printer.save_variables.variables.lang == 2 else "X bewegen:" if printer.save_variables.variables.lang == 3 else "Move X:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.x}
input_min: {printer.toolhead.axis_minimum.x}
input_max: {printer.toolhead.axis_maximum.x}
input_step: 0.1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 X{menu.input}
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move01mm __axis_y]
type: input
name: { "Pohyb Y:" if printer.save_variables.variables.lang == 2 else "Y bewegen:" if printer.save_variables.variables.lang == 3 else "Move Y:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.y}
input_min: {printer.toolhead.axis_minimum.y}
input_max: {printer.toolhead.axis_maximum.y}
input_step: 0.1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 Y{menu.input}
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move01mm __axis_z]
type: input
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb Z:" if printer.save_variables.variables.lang == 2 else "Z bewegen:" if printer.save_variables.variables.lang == 3 else "Move Z:" } {'%05.1f' % menu.input}
input: {printer.gcode_move.gcode_position.z}
input_min: 0
input_max: {printer.toolhead.axis_maximum.z}
input_step: 0.1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    G90
    G1 Z{menu.input} F720
    RESTORE_GCODE_STATE NAME=__move__axis

[menu __main __control __move __move01mm __axis_e]
type: input
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Pohyb E:" if printer.save_variables.variables.lang == 2 else "E bewegen:" if printer.save_variables.variables.lang == 3 else "Move E:" } {'%+06.1f' % menu.input}
input: 0
input_min: -{printer.configfile.config.extruder.max_extrude_only_distance|default(50)}
input_max: {printer.configfile.config.extruder.max_extrude_only_distance|default(50)}
input_step: 0.1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__move__axis
    M83
    G1 E{menu.input} F240
    RESTORE_GCODE_STATE NAME=__move__axis

# Home:
[menu __main __control __home]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Domu vse" if printer.save_variables.variables.lang == 2 else "Home Alle" if printer.save_variables.variables.lang == 3 else "Home All" }
index: 2
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
	G28 X Y
	G28 Z

[menu __main __control __homexy]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Domu XY" if printer.save_variables.variables.lang == 2 else "Home XY" if printer.save_variables.variables.lang == 3 else "Home XY" }
index: 3
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    G28 X Y

[menu __main __control __home_z]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Domu Z" if printer.save_variables.variables.lang == 2 else "Home Z" if printer.save_variables.variables.lang == 3 else "Home Z" }
index: 4
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    G28 Z

# Park toolhead
[menu __main __control __park]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
index: 5
name: { "Zaparkovat" if printer.save_variables.variables.lang == 2 else "Werkzeugpark" if printer.save_variables.variables.lang == 3 else "Park toolhead" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    Park_Toolhead

# Steppers Off
[menu __main __control __disable]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
index: 6
name: { "Vypnout motory" if printer.save_variables.variables.lang == 2 else "Motoren aus" if printer.save_variables.variables.lang == 3 else "Steppers off" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    steppers_off

# E Stepper off:
[menu __main __control __estepperoff]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Vypnout E motor" if printer.save_variables.variables.lang == 2 else "E Motor aus" if printer.save_variables.variables.lang == 3 else "E Stepper off" }
index: 7
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    e_stepper_off

# Fans
[menu __main __control __fanonoff]
type: input
enable: {'fan' in printer}
index: 8
name: { "Ventilator:" if printer.save_variables.variables.lang == 2 else "Lufter:" if printer.save_variables.variables.lang == 3 else "Fan:" } {'ON ' if menu.input else 'OFF'}
input: {printer.fan.speed}
input_min: 0
input_max: 1
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M106 S{255 if menu.input else 0}

[menu __main __control __fanspeed]
type: input
enable: {'fan' in printer}
index: 9
name: { "Ventilator:" if printer.save_variables.variables.lang == 2 else "Lufter:" if printer.save_variables.variables.lang == 3 else "Fan speed:" } {'%2d' % (menu.input*100)}%
input: {printer.fan.speed}
input_min: 0
input_max: 1
input_step: 0.01
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M106 S{'%d' % (menu.input*255)}


##############################################################
##    Menu - Temperature                                     #
##############################################################

[menu __main __temp]
type: list
name: { "Teplota" if printer.save_variables.variables.lang == 2 else "Temperatur" if printer.save_variables.variables.lang == 3 else "Temperature" }
enable: {not printer.idle_timeout.state == "Printing"}

[menu __main __temp __hotend0_target]
type: input
enable: {('extruder' in printer) and ('extruder' in printer.heaters.available_heaters)}
name: {"Ext:%3.0f (%4.0f)~degrees~" % (menu.input, printer.extruder.temperature)}
input: {printer.extruder.target}
input_min: 0
input_max: {printer.configfile.config.extruder.max_temp}
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 T0 S{'%.0f' % menu.input}

[menu __main __temp __hotbed_target]
type: input
enable: {'heater_bed' in printer}
name: {"Bed:%3.0f (%4.0f)~degrees~" % (menu.input, printer.heater_bed.temperature)}
input: {printer.heater_bed.target}
input_min: 0
input_max: {printer.configfile.config.heater_bed.max_temp}
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S{'%.0f' % menu.input}

# Preheat PLA:
[menu __main __temp __preheat_pla]
type: list
name: { "Predehrat PLA" if printer.save_variables.variables.lang == 2 else "PLA vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat PLA" }

[menu __main __temp __preheat_pla __all]
type: command
enable: {('extruder' in printer) and ('heater_bed' in printer)}
name: { "Predehrat vse" if printer.save_variables.variables.lang == 2 else "Alles vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat all" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S50
    M104 S200
    {menu.exit()}

[menu __main __temp __preheat_pla __hotend]
type: command
enable: {'extruder' in printer}
name: Hotend: 200~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 S200
    {menu.exit()}

[menu __main __temp __preheat_pla __hotbed]
type: command
enable: {'heater_bed' in printer}
name: Bed:    50~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S50
    {menu.exit()}

# Preheat PETG:
[menu __main __temp __preheat_petg]
type: list
name: { "Predehrat PETG" if printer.save_variables.variables.lang == 2 else "PETG vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat PETG" }
index: 4

[menu __main __temp __preheat_petg __all]
type: command
enable: {('extruder' in printer) and ('heater_bed' in printer)}
name: { "Predehrat vse" if printer.save_variables.variables.lang == 2 else "Alles vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat all" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S60
    M104 S220
    {menu.exit()}

[menu __main __temp __preheat_petg __hotend]
type: command
enable: {'extruder' in printer}
name: Hotend: 220~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 S220
    {menu.exit()}

[menu __main __temp __preheat_petg __hotbed]
type: command
enable: {'heater_bed' in printer}
name: Bed:    60~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S60
    {menu.exit()}

# Preheat ABS:
[menu __main __temp __preheat_abs]
type: list
name: { "Predehrat ABS" if printer.save_variables.variables.lang == 2 else "ABS vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat ABS" }

[menu __main __temp __preheat_abs __all]
type: command
enable: {('extruder' in printer) and ('heater_bed' in printer)}
name: { "Predehrat vse" if printer.save_variables.variables.lang == 2 else "Alles vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat all" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S80
    M104 S245
    {menu.exit()}

[menu __main __temp __preheat_abs __hotend]
type: command
enable: {'extruder' in printer}
name: Hotend: 245~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 S245
    {menu.exit()}

[menu __main __temp __preheat_abs __hotbed]
type: command
enable: {'heater_bed' in printer}
name: Bed:    80~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S80
    {menu.exit()}

# Preheat PROBE:
[menu __main __temp __preheat_probe]
type: list
name: { "Predehrat PROBE" if printer.save_variables.variables.lang == 2 else "PROBE vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat PROBE" }
index: 6

[menu __main __temp __preheat_probe __all]
type: command
enable: {('extruder' in printer) and ('heater_bed' in printer)}
name: { "Predehrat vse" if printer.save_variables.variables.lang == 2 else "Alles vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat all" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S50
    M104 S150
    {menu.exit()}

[menu __main __temp __preheat_probe __hotend]
type: command
enable: {'extruder' in printer}
name: Hotend: 150~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 S150
    {menu.exit()}

[menu __main __temp __preheat_probe __hotbed]
type: command
enable: {'heater_bed' in printer}
name: Bed:    50~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S50
    {menu.exit()}

# COOLDOWN:
[menu __main __temp __cooldown]
type: list
name: { "Vyp. ohrev" if printer.save_variables.variables.lang == 2 else "Abkuhlen" if printer.save_variables.variables.lang == 3 else "Cooldown" }

[menu __main __temp __cooldown __all]
type: command
enable: {('extruder' in printer) and ('heater_bed' in printer)}
name: { "Vypnout vse" if printer.save_variables.variables.lang == 2 else "Alles abkuhlen" if printer.save_variables.variables.lang == 3 else "Cooldown all" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 S0
    M140 S0
    {menu.exit()}

[menu __main __temp __cooldown __hotend]
type: command
enable: {'extruder' in printer}
name: { "Vyp. hotend" if printer.save_variables.variables.lang == 2 else "Hotend AUS" if printer.save_variables.variables.lang == 3 else "Hotend off" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 S0
    {menu.exit()}

[menu __main __temp __cooldown __hotbed]
type: command
enable: {'heater_bed' in printer}
name: { "Vyp. hotbed" if printer.save_variables.variables.lang == 2 else "Bett AUS" if printer.save_variables.variables.lang == 3 else "Hotbed off" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S0
    {menu.exit()}

	   
##############################################################
##    Menu - Filament                                        #
##############################################################

[menu __main __filament]
type: list
name: { "Filament" if printer.save_variables.variables.lang == 2 else "Filament" if printer.save_variables.variables.lang == 3 else "Filament" }
enable: {not printer.idle_timeout.state == "Printing"}

[menu __main __filament __hotend0_target]
type: input
enable: {'extruder' in printer}
name: {"Ext:%3.0f (%4.0f)~degrees~" % (menu.input, printer.extruder.temperature)}
index: 0
input: {printer.extruder.target}
input_min: 0
input_max: {printer.configfile.config.extruder.max_temp}
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 T0 S{'%.0f' % menu.input}

# LOAD
[menu __main __filament __load]
type: list
name: { "Nacist fil." if printer.save_variables.variables.lang == 2 else "Filament laden" if printer.save_variables.variables.lang == 3 else "Load filament" }
enable: True
index: 1

[menu __main __filament __load _pla]
type: command
name: { "Nacist PLA" if printer.save_variables.variables.lang == 2 else "PLA laden" if printer.save_variables.variables.lang == 3 else "Load PLA" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__load
    {% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
         _TOOLHEAD_PARK_PAUSE_CANCEL
         M109 S200
         M83
         G1 E50 F240
    {% else %}
         M109 S200
         M83
         G1 E50 F240 
    {% endif %}
	RESTORE_GCODE_STATE NAME=__filament__load

[menu __main __filament __load _petg]
type: command
name: { "Nacist PETG" if printer.save_variables.variables.lang == 2 else "PETG laden" if printer.save_variables.variables.lang == 3 else "Load PETG" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__load
    {% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
         _TOOLHEAD_PARK_PAUSE_CANCEL
         M109 S220
         M83
         G1 E50 F240
    {% else %}
         M109 S220
         M83
         G1 E50 F240 
    {% endif %}
	RESTORE_GCODE_STATE NAME=__filament__load

[menu __main __filament __load _abs]
type: command
name: { "Nacist ABS" if printer.save_variables.variables.lang == 2 else "ABS laden" if printer.save_variables.variables.lang == 3 else "Load ABS" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__load
    {% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
         _TOOLHEAD_PARK_PAUSE_CANCEL
         M109 S245
         M83
         G1 E50 F240
    {% else %}
         M109 S245
         M83
         G1 E50 F240 
    {% endif %}
	RESTORE_GCODE_STATE NAME=__filament__load

# UNLOAD
[menu __main __filament __unload]
type: list
name: { "Vyjmout fil." if printer.save_variables.variables.lang == 2 else "Fil. entladen" if printer.save_variables.variables.lang == 3 else "Unload filament" }
enable: True
index: 2

[menu __main __filament __unload _pla]
type: command
name: { "Vyjmout PLA" if printer.save_variables.variables.lang == 2 else "PLA entladen" if printer.save_variables.variables.lang == 3 else "Unload PLA" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__unload
    {% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
         _TOOLHEAD_PARK_PAUSE_CANCEL
         M109 S200
         M83
         G1 E-70 F300
     {% else %}
         M109 S200
         M83
         G1 E-70 F300 
    {% endif %}
	RESTORE_GCODE_STATE NAME=__filament__unload   
	
[menu __main __filament __unload _petg]
type: command
name: { "Vyjmout PETG" if printer.save_variables.variables.lang == 2 else "PETG entladen" if printer.save_variables.variables.lang == 3 else "Unload PETG" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__unload
    {% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
         _TOOLHEAD_PARK_PAUSE_CANCEL
         M109 S220
         M83
         G1 E-70 F300
     {% else %}
         M109 S220
         M83
         G1 E-70 F300 
    {% endif %}
	RESTORE_GCODE_STATE NAME=__filament__unload   
	
[menu __main __filament __unload _abs]
type: command
name: { "Vyjmout ABS" if printer.save_variables.variables.lang == 2 else "ABS entladen" if printer.save_variables.variables.lang == 3 else "Unload ABS" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__unload
    {% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
         _TOOLHEAD_PARK_PAUSE_CANCEL
         M109 S245
         M83
         G1 E-70 F300
     {% else %}
         M109 S245
         M83
         G1 E-70 F300 
    {% endif %}
	RESTORE_GCODE_STATE NAME=__filament__unload 

# Filament Change
[menu __main __filament __M600]
type: list
enable: True 
name: { "Vymenit fil." if printer.save_variables.variables.lang == 2 else "Fil. wechseln" if printer.save_variables.variables.lang == 3 else "Change Filament" }
index: 3

[menu __main __filament __M600 __plaM600]
type: command
enable: True 
name: { "Vymenit PLA" if printer.save_variables.variables.lang == 2 else "PLA wechseln" if printer.save_variables.variables.lang == 3 else "Change PLA" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__m600
    M109 S200
    M600
    RESTORE_GCODE_STATE NAME=__filament__m600
    
[menu __main __filament __M600 __petgM600]
type: command
enable: True 
name: { "Vymenit PETG" if printer.save_variables.variables.lang == 2 else "PETG wechseln" if printer.save_variables.variables.lang == 3 else "Change PETG" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__m600
    M109 S220
    M600
    RESTORE_GCODE_STATE NAME=__filament__m600
    
[menu __main __filament __M600 __absM600]
type: command
enable: True 
name: { "Vymenit ABS" if printer.save_variables.variables.lang == 2 else "ABS wechseln" if printer.save_variables.variables.lang == 3 else "Change ABS" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__m600
    M109 S245
    M600
    RESTORE_GCODE_STATE NAME=__filament__m600

# E MOVE
[menu __main __filament __feed]
type: input
name: { "E Posun:" if printer.save_variables.variables.lang == 2 else "E bewegen:" if printer.save_variables.variables.lang == 3 else "Move E:" } {'%.1f' % menu.input} mm
index: 4
input: 5
input_step: 0.1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_GCODE_STATE NAME=__filament__load
    M83
    G1 E{'%.1f' % menu.input} F60
    RESTORE_GCODE_STATE NAME=__filament__load

# E Stepper Off
[menu __main __filament __estepperoff]
type: command
enable: True 
name: { "Vyp. E motor" if printer.save_variables.variables.lang == 2 else "E motor aus" if printer.save_variables.variables.lang == 3 else "E Stepper off" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    e_stepper_off


##############################################################
##    Menu - lights                                          #
##############################################################

[menu __main __lights]
type: list
enable: True  
name: { "Svetla" if printer.save_variables.variables.lang == 2 else "Licht" if printer.save_variables.variables.lang == 3 else "Lights" }
index: 6

[menu __main __lights __lightsonoff]
type: input
enable: True
name: { "Svetla:" if printer.save_variables.variables.lang == 2 else "Licht:" if printer.save_variables.variables.lang == 3 else "Lights:" } {'ON ' if menu.input else 'OFF'}
input: {printer["gcode_macro lights_var"].onoff | int}
input_min: 0
input_max: 1
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %}   
       {% set VALUE_ONOFF = menu.input | int %}
       lights_var ONOFF={ VALUE_ONOFF }
       set_onoff_lights

[menu __main __lights __lightsbright]
type: input
enable: True 
name: { "Jas:" if printer.save_variables.variables.lang == 2 else "Helligkeit:" if printer.save_variables.variables.lang == 3 else "Bright:" } {'%2d' %(menu.input*100)}%
input: {printer["gcode_macro lights_var"].bright | float | round(1)}
input_min: 0.0
input_max: 1.0
input_step: 0.1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {% set VALUE_BRIGHT = menu.input | float | round(1) %}
    lights_var BRIGHT={ VALUE_BRIGHT }
    set_bright_lights	

[menu __main __lights __max]
type: command
name: { "Jas na max" if printer.save_variables.variables.lang == 2 else "Licht max." if printer.save_variables.variables.lang == 3 else "Bright on max" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    lights_max

[menu __main __lights __lights_red]
type: input
enable: True
index: 4
name: { "Red:" if printer.save_variables.variables.lang == 2 else "Rot:" if printer.save_variables.variables.lang == 3 else "Red:" } {'%1.2f' %(menu.input)}
input: {printer["gcode_macro lights_var"].red | float | round(2)}
input_min: 0.00
input_max: 1.00
input_step: 0.01
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {% set VALUE_RED = menu.input | float | round(2) %}
	SET_GCODE_VARIABLE MACRO=lights_var VARIABLE=red VALUE={ VALUE_RED }
    SAVE_VARIABLE VARIABLE=red VALUE={ VALUE_RED }             
    set_rgb_lights     
	
[menu __main __lights __lights_green]
type: input
enable: True
index: 5
name: { "Green:" if printer.save_variables.variables.lang == 2 else "Grun:" if printer.save_variables.variables.lang == 3 else "Green:" } {'%1.2f' %(menu.input)}
input: {printer["gcode_macro lights_var"].green | float | round(2)}
input_min: 0.00
input_max: 1.00
input_step: 0.01
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {% set VALUE_GREEN = menu.input | float | round(2) %}
	SET_GCODE_VARIABLE MACRO=lights_var VARIABLE=green VALUE={ VALUE_GREEN }
    SAVE_VARIABLE VARIABLE=green VALUE={ VALUE_GREEN }
	set_rgb_lights
	
[menu __main __lights __lights_blue]
type: input
enable: True
index: 6
name: { "Blue:" if printer.save_variables.variables.lang == 2 else "Blau:" if printer.save_variables.variables.lang == 3 else "Blue:" } {'%1.2f' %(menu.input)}
input: {printer["gcode_macro lights_var"].blue | float | round(2)}
input_min: 0.00
input_max: 1.00
input_step: 0.01
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {% set VALUE_BLUE = menu.input | float | round(2) %}
	SET_GCODE_VARIABLE MACRO=lights_var VARIABLE=blue VALUE={ VALUE_BLUE }
    SAVE_VARIABLE VARIABLE=blue VALUE={ VALUE_BLUE }	
    set_rgb_lights	


##############################################################
##    Chamber:                                               #
##############################################################

[menu __main __chamber]
type: list
enable: True 
name: { "Komora" if printer.save_variables.variables.lang == 2 else "Kammer" if printer.save_variables.variables.lang == 3 else "Chamber" }
index: 7

[menu __main __chamber __chamber_temp]
type: command
name: { "Aktualne:" if printer.save_variables.variables.lang == 2 else "Aktuell:" if printer.save_variables.variables.lang == 3 else "Current:" } {'%2.0f' % (printer['temperature_fan Chamber_fans'].temperature)}~degrees~C
gcode:

[menu __main __chamber __target_temp]
type: input
name: { "Chlazeni:" if printer.save_variables.variables.lang == 2 else "Cool bei:" if printer.save_variables.variables.lang == 3 else "Cooling:" } {'%2.0f' % (menu.input)}~degrees~C
input: {printer['temperature_fan Chamber_fans'].target}
input_min: 15
input_max: 70
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M141 S{'%.0f' % menu.input}


##############################################################
##    Menu - SETUP                                           #
##############################################################

[menu __main __setup]
type: list
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Nastaveni" if printer.save_variables.variables.lang == 2 else "Einstellungen" if printer.save_variables.variables.lang == 3 else "Setup" }

[menu __main __setup __restart]
type: list
name: { "Napajeni" if printer.save_variables.variables.lang == 2 else "Energie" if printer.save_variables.variables.lang == 3 else "Power Manag." }

[menu __main __setup __restart __host_restart]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Restartovat" if printer.save_variables.variables.lang == 2 else "Neustart" if printer.save_variables.variables.lang == 3 else "Restart" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    RESTART

[menu __main __setup __restart __firmware_restart]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Restart FW" if printer.save_variables.variables.lang == 2 else "FW Neustart" if printer.save_variables.variables.lang == 3 else "Restart FW" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    FIRMWARE_RESTART

[menu __main __setup __restart __power_off] 
type: command
enable: {not (printer.print_stats.state == "printing" or printer.print_stats.state == "paused") and 'gcode_macro _POWER_OFF_PRINTER' in printer}
name: { "Vypnout" if printer.save_variables.variables.lang == 2 else "Ausschalten" if printer.save_variables.variables.lang == 3 else "Power Off" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {menu.exit()} _POWER_OFF_PRINTER


## Calibration:
[menu __main __setup __calib]
type: list
name: { "Kalibrace" if printer.save_variables.variables.lang == 2 else "Kalibrierung" if printer.save_variables.variables.lang == 3 else "Calibration" }

# Preheat:
[menu __main __setup __calib __preheat]
type: list
name: { "Predehrat" if printer.save_variables.variables.lang == 2 else "Vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat" }
index: 1

[menu __main __setup __calib __preheat __all]
type: command
enable: {('extruder' in printer) and ('heater_bed' in printer)}
name: { "Predehrat vse" if printer.save_variables.variables.lang == 2 else "Alles vorheizen" if printer.save_variables.variables.lang == 3 else "Preheat all" }
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S50
    M104 S150

[menu __main __setup __calib __preheat __hotend]
type: command
enable: {'extruder' in printer}
name: Hotend: 150~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M104 S150

[menu __main __setup __calib __preheat __hotbed]
type: command
enable: {'heater_bed' in printer}
name: Bed:    50~degrees~C
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    M140 S50

# Home All:
[menu __main __setup __calib __home]
type: command
enable: {not printer.idle_timeout.state == "Printing"}
name: { "Domu vse" if printer.save_variables.variables.lang == 2 else "Home Alle" if printer.save_variables.variables.lang == 3 else "Home All" }
index: 2
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
	G28 X Y
	G28 Z

# Z TILT:
[menu __main __setup __calib __ztilt]
type: command
index: 3
enable: {not printer.idle_timeout.state == "Printing" and ('z_tilt' in printer)}
name: Z Tilt
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    Z_TILT_ADJUST

# Bed mesh
[menu __main __setup __calib __bedmesh]
type: command
index: 4
enable: {not printer.idle_timeout.state == "Printing" and ('bed_mesh' in printer)}
name: Bed Mesh
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    BED_MESH_CALIBRATE

# PID
[menu __main __setup __calib __tuning]
type: list
name: { "PID kalibrace" if printer.save_variables.variables.lang == 2 else "PID-Kalibrier." if printer.save_variables.variables.lang == 3 else "PID tuning" }
index: 5

[menu __main __setup __calib __tuning __hotend_pid_tuning]
type: command
enable: {(not printer.idle_timeout.state == "Printing") and ('extruder' in printer)}
name: Hotend PID
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    PID_CALIBRATE HEATER=extruder TARGET=200 WRITE_FILE=1

[menu __main __setup __calib __tuning __hotbed_pid_tuning]
type: command
enable: {(not printer.idle_timeout.state == "Printing") and ('heater_bed' in printer)}
name: Hotbed PID
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    PID_CALIBRATE HEATER=heater_bed TARGET=50 WRITE_FILE=1

# Z ENDSTOP CALIBRATE
[menu __main __setup __calib __z_endstop_calibrate]
type: command
index: 7
enable: {(not printer.idle_timeout.state == "Printing"  or printer.print_stats.state == "paused")}
name:  Z endstop calibrate
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    Z_ENDSTOP_CALIBRATE

# PROBE CALIBRATE
[menu __main __setup __calib __probe_calibrate]
type: command
index: 8
enable: {(not printer.idle_timeout.state == "Printing"  or printer.print_stats.state == "paused")}
name:  Probe calibrate 
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    PROBE_CALIBRATE 

# Save Config and restart
[menu __main __setup __calib __saveconfig]
type: command
name: Save config
index: 9
enable: {(not printer.idle_timeout.state == "Printing"  or printer.print_stats.state == "paused")}
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SAVE_CONFIG

# Language change:
[menu __main __setup __language_selection]
type: list
name: { "Zmena jazyka" if printer.save_variables.variables.lang == 2 else "Sprache" if printer.save_variables.variables.lang == 3 else "Language" }
index: 10

[menu __main __setup __language_selection __english]
type: command
name: English
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SET_MENU_LANGUAGE LANGUAGE=1
    {menu.back()}

[menu __main __setup __language_selection __czech]
type: command
name: Cestina
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SET_MENU_LANGUAGE LANGUAGE=2
    {menu.back()}

[menu __main __setup __language_selection __german]
type: command
name: Deutsch
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    SET_MENU_LANGUAGE LANGUAGE=3
    {menu.back()}

# Knob feedback change:
[menu __main __setup __knob]
type: list
name: { "LCD tlacitko" if printer.save_variables.variables.lang == 2 else "Anzeige Taste" if printer.save_variables.variables.lang == 3 else "Display knob" }
index: 11

[menu __main __setup __knob __knob_onoff]
type: input
enable: True
name: { "Odezva:" if printer.save_variables.variables.lang == 2 else "Ruckmeld:" if printer.save_variables.variables.lang == 3 else "Feedback:" } {'ON ' if menu.input else 'OFF'}
input: {printer["gcode_macro knob_feedback"].knob | int}
input_min: 0
input_max: 1
input_step: 1
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 0 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    {% set knob_onoff = menu.input | int %}
    knob_feedback KNOB={knob_onoff}

[menu __main __setup __Bed_Lowriding]
type: command
name: Bed Lowrider
index: 11
gcode:
    {% set value_knob = printer["gcode_macro knob_feedback"].knob %}
	{% if value_knob == 1 %}
       SET_LED LED=Display_LED RED=0 GREEN=1 BLUE=0 INDEX=1 TRANSMIT=1
       UPDATE_DELAYED_GCODE ID=knob_feedback_return DURATION=0.5  
    {% endif %} 
    Bed_Lowrider





###############################################################################################################  
## The items below are disabled due to being moved to another menu section or unused (left here for hiding).

[menu __main __control __bed_mesh]
type: command
enable: False
name: Bed Mesh
gcode: BED_MESH_CALIBRATE

[menu __main __control __z_tilt]
type: command
enable: {not printer.idle_timeout.state == "Printing" and ('z_tilt' in printer)}
enable: False
name: Z Tilt
gcode: Z_TILT_ADJUST

[menu __main __setup __save_config]
type: command
name: Save config
enable: False
gcode: SAVE_CONFIG

# Make probe
[menu __main __setup __calib __bedprobe]
type: command
index: 6
name: Make probe
enable: False
gcode: PROBE

## Dump:
[menu __main __setup __dump]
type: command
name: Dump
enable: False
gcode:
   {% for name1 in printer %}
      {% for name2 in printer[name1] %}
         { action_respond_info("printer['%s'].%s = %s"
                               % (name1, name2, printer[name1][name2])) }
      {% else %}
         { action_respond_info("printer['%s'] = %s" % (name1, printer[name1])) }
      {% endfor %}
   {% endfor %}

## Second hotend:
[menu __main __temp __hotend1_target]
type: input
enable: {('extruder1' in printer) and ('extruder1' in printer.heaters.available_heaters)}
name: {"Ex1:%3.0f (%4.0f)" % (menu.input, printer.extruder1.temperature)}
input: {printer.extruder1.target}
input_min: 0
input_max: {printer.configfile.config.extruder1.max_temp}
input_step: 1
gcode: M104 T1 S{'%.0f' % menu.input}

### CASELIGHT - Pin PWM - Not work with Neopixel RGB - UNUSED
[menu __main __control __caselightonoff]
type: input
enable: {'output_pin caselight' in printer}
name: Lights: {'ON ' if menu.input else 'OFF'}
input: {printer['output_pin caselight'].value}
input_min: 0
input_max: 1
input_step: 1
gcode:
    SET_PIN PIN=caselight VALUE={1 if menu.input else 0}

[menu __main __control __caselightpwm]
type: input
enable: {'output_pin caselight' in printer}
name: Lights: {'%3d' % (menu.input*100)}%
input: {printer['output_pin caselight'].value}
input_min: 0.0
input_max: 1.0
input_step: 0.01
gcode:
    SET_PIN PIN=caselight VALUE={menu.input}

[menu __main __control __quad_gantry_level]
type: command
enable: {not printer.idle_timeout.state == "Printing" and ('quad_gantry_level' in printer)}
name: Quad Gantry Lvl
gcode: QUAD_GANTRY_LEVEL

### Origin menu Home Z - DISABLED ###
[menu __main __control __homez]
type: command
enable: False
name: Home Z

### Origin menu MOVE XYZE - DISABLED ###
[menu __main __control __move_10mm]
type: list
enable: False
name: Move 10mm

[menu __main __control __move_1mm]  
type: list
enable: False
name: Move 1mm

[menu __main __control __move_01mm]   
type: list
enable: False
name: Move 0.1mm

### menu for OCTOPRINT - DISABLED ###
[menu __main __octoprint]
type: list
name: Octoprint
enable: False

### Origin Filament LOAD/UNLOAD - DISABLED
[menu __main __filament __loads]
type: command
name: Load Fil. slow
enable: False
gcode:
    SAVE_GCODE_STATE NAME=__filament__load
    M83
    G1 E50 F240
    RESTORE_GCODE_STATE NAME=__filament__load

[menu __main __filament __loadf]
type: command
name: Load Fil. fast
enable: False
gcode:
    SAVE_GCODE_STATE NAME=__filament__load
    M83
    G1 E50 F960
    RESTORE_GCODE_STATE NAME=__filament__load

[menu __main __filament __unloads]
type: command
name: Unload Fil.slow
enable: False
gcode:
    SAVE_GCODE_STATE NAME=__filament__load
    M83
    G1 E-50 F240
    RESTORE_GCODE_STATE NAME=__filament__load

[menu __main __filament __unloadf]
type: command
name: Unload Fil.fast
enable: False
gcode:
    SAVE_GCODE_STATE NAME=__filament__load
    M83
    G1 E-50 F960
    RESTORE_GCODE_STATE NAME=__filament__load

# Origin place of PID 
[menu __main __setup __tuning]
type: list
name: PID tuning
enable: False

## DELTA
[menu __main __setup __calib __delta_calib_man __start]
type: command
name: Start probing
gcode:
    G28
    DELTA_CALIBRATE METHOD=manual

[menu __main __setup __calib __delta_calib_man __move_z]
type: input
name: Move Z: {'%03.2f' % menu.input}
input: {printer.gcode_move.gcode_position.z}
input_step: 1
realtime: True
gcode:
    {%- if menu.event == 'change' -%}
        G1 Z{'%.2f' % menu.input}
    {%- elif menu.event == 'long_click' -%}
        G1 Z{'%.2f' % menu.input}
        SAVE_GCODE_STATE NAME=__move__axis
        G91
        G1 Z2
        G1 Z-2
        RESTORE_GCODE_STATE NAME=__move__axis
    {%- endif -%}

[menu __main __setup __calib __delta_calib_man __test_z]
type: input
name: Test Z: {['++','+','+.01','+.05','+.1','+.5','-.5','-.1','-.05','-.01','-','--'][menu.input|int]}
input: 6
input_min: 0
input_max: 11
input_step: 1
gcode:
    {%- if menu.event == 'long_click' -%}
        TESTZ Z={['++','+','+.01','+.05','+.1','+.5','-.5','-.1','-.05','-.01','-','--'][menu.input|int]}
    {%- endif -%}

[menu __main __setup __calib __delta_calib_man __accept]
type: command
name: Accept
gcode: ACCEPT

[menu __main __setup __calib __delta_calib_man __abort]
type: command
name: Abort
gcode: ABORT